<!DOCTYPE html>
<html>
  <head>
    <title>Q - Project - Rive Icon Test</title>
    <meta charset="UTF-8" />
    <script src="https://unpkg.com/@rive-app/canvas@2.24.0"></script>

    <style>
      :root{
        --size: 140px;   /* розмір канвасу */
        --gap: 16px;     /* відступи між іконками */
        --cols: 6;       /* максимум колонок у рядку */
      }

      @font-face {
        font-family: 'Otoiwogrotesk';
        src: url('fonts/otoiwogrotesknormal-regular_w.ttf') format('truetype');
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }

      body {
        display: flex;
        flex-direction: column;
        gap: 48px;
        padding-top: 40px;
        justify-content: center;   /* центрує контейнер по горизонталі */
        align-items: center;       /* центрує по вертикалі, якщо є вільний простір */
        min-height: 100vh;         /* щоб вертикальне центрування працювало */
        background: #050505;          /* або будь-який інший колір фону */
        font-family: 'Otoiwogrotesk', sans-serif;
      }

      h3 {
        font-size: 20px;
        margin: 0 0 0px;
      }

      p {
        margin: 0;
        opacity: .8;
        font-size: 14px;
        line-height: 1.4;
      }

      #icons{
        display: grid;
        grid-template-columns: repeat(var(--cols), var(--size)); /* рівно 6 колонок */
        grid-auto-rows: var(--size);
        gap: var(--gap);
        justify-content: center;   /* починаємо зліва */
        align-content: center;
        /* необов’язково, але зручно обмежити ширину контейнера під 6 колонок */
        max-width: calc(var(--cols) * var(--size) + (var(--cols) - 1) * var(--gap));
      }

      #icons canvas{
        width: var(--size);
        height: var(--size);
        display: block; /* щоб не було inline-відступів */
        background-color: #4B4B52;
        border-radius: 0px
      }

      .service-card {
        width: 600px;
        overflow: hidden;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        color: #fff;
      }

      .card-media {
        width: 100%;
        height: 398px; /* висоту можна змінити під свій макет */
        position: relative;
      }

      .card-media canvas {
        width: 100% !important;
        height: 100% !important;
        object-fit: cover;
        
      }

      .card-content {
        position: relative;
        margin-top: 24px;
      }

      .card-icon {
        width: 56px;
        height: 56px;
        
        display: block;
        background-color: #4B4B52;
      }

      .card-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 12px;
      }

      .card-icon {
        width: 40px;
        height: 40px;
        flex-shrink: 0;
      }

      .card-header h3 {
        white-space: wrap; /* не буде ламати в дивний спосіб */
      }

    </style>

  </head>

  <body>
    <div style="text-align: center">
      <h1 style="color: #fff;">Qommett Icon Pack</h1>
      <br></br>
      <div id="icons" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:16px"></div>
      <br></br>
      <p style="color: #4B4B52;">reload page (CTRL+R) to show appearance animation</p>  
      
      <script>
        const ARTBOARD = 'Icon';
        const STATE_MACHINE = 'State Machine 1';
        const CANVAS_PREFIX = 'c';

        // масив інстансів Rive
        const r = [];

        async function boot() {
          const res  = await fetch('Icons/icon_list.json');
          const data = await res.json();
          const files = Array.isArray(data) ? data : (data.icons || []);

          const wrap = document.getElementById('icons');
          if (!files.length) {
            wrap.textContent = 'Немає .riv у Icons/';
            return;
          } 

          files.forEach((file, i) => {
            // створюємо canvas з id c1, c2, c3...
            const id = `${CANVAS_PREFIX}${i + 1}`;
            const canvas = document.createElement('canvas');
            canvas.id = id;
            canvas.width = 140;   // підстав свій розмір
            canvas.height = 140;  // підстав свій розмір
            wrap.appendChild(canvas);

            // створюємо Rive інстанс і кладемо в масив
            const instance = new rive.Rive({
              src: `Icons/${file}`,   // беремо ім’я з JSON
              canvas,
              autoplay: true,
              artboard: ARTBOARD,
              stateMachines: STATE_MACHINE,
              onLoad: () => instance.resizeDrawingSurfaceToCanvas()
            });

            r.push(instance);
          });
        }

        boot().catch(err => {
          console.error(err);
          document.getElementById('icons').textContent = 'Помилка завантаження іконок.';
        });
      </script>      
             

    </div>
    
    <div class="service-list">

      <div id="service-card-2" class="service-card">
        <div class="card-media">
          <canvas id="service_card_2_image"></canvas>
        </div>
        <div class="card-content">
          <div class="card-header">
            <canvas id="service_card_2_icon" class="card-icon"></canvas>
            <h3>Розумний пошук</h3>
          </div>
          <p>Розумний пошук із персоналізацією та рекомендаціями, що підвищуює релевантність, конверсію та середній чек.</p>
        </div>

        <script>
        const card2 = document.getElementById("service-card-2");
        let imgHover2, iconHover2;

        const img2 = new rive.Rive({
          src: "Images/gag_img.riv",
          canvas: document.getElementById("service_card_2_image"),
          autoplay: true,
          stateMachines: "State Machine 1",
          onLoad: () => {
            img2.resizeDrawingSurfaceToCanvas();
            imgHover2 = img2.stateMachineInputs("State Machine 1").find(i => i.name === "Hover");
          }
        });

        const icon2 = new rive.Rive({
          src: "Icons/search_icon.riv",
          canvas: document.getElementById("service_card_2_icon"),
          autoplay: true,
          stateMachines: "State Machine 1",
          onLoad: () => {
            icon2.resizeDrawingSurfaceToCanvas();
            iconHover2 = icon2.stateMachineInputs("State Machine 1").find(i => i.name === "Hover");
          }    
        });

        // універсальний сеттер для Boolean/Trigger/Number
        function setInput(input, v) {
          if (!input) return;
          if ('value' in input && typeof input.value === 'boolean') { input.value = !!v; return; }
          if ('value' in input && typeof input.value === 'number')  { input.value = v ? 1 : 0; return; }
          if (typeof input.fire === 'function' && v) input.fire(); // тригер — лише вперед
        }
        
        function setHover(v) {
          setInput(imgHover2, v);
          setInput(iconHover2, v);
        }

        // hover саме на контенті картки
        card2.addEventListener('mouseenter', () => setHover(true));
        card2.addEventListener('mouseleave', () => setHover(false));

      </script>
      </div>
      
    </div>
  </body>

</html>

